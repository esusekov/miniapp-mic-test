(this["webpackJsonpminiapp-mic-test"]=this["webpackJsonpminiapp-mic-test"]||[]).push([[0],{140:function(e,t,o){"use strict";o.r(t);var n=o(0),s=o.n(n),r=o(14),a=o.n(r),i=o(15),c=o.n(i),l=o(21),u=o(11),d=(o(138),o(9)),j=o.n(d),m=o(3),p=function(){var e=function(){var e=s.a.useRef();return s.a.useEffect((function(){var t=e.current;console.log("root",t);var o,n,s,r=t.getElementsByTagName("path"),a=t.querySelector("#visualizer"),i=a.querySelector("#mask"),c=t.getElementsByTagName("h1")[0],l=t.getElementsByTagName("h1")[1],u=!1,d=!1,m=0,p=function(e){console.log("soundAllowed 0"),d=!0;var t=n.createMediaStreamSource(e),o=n.createAnalyser();o.fftSize=1024,t.connect(o);var j=o.frequencyBinCount,p=new Uint8Array(j);a.setAttribute("viewBox","0 0 255 255");for(var h=0;h<255;h++)(s=document.createElementNS("http://www.w3.org/2000/svg","path")).setAttribute("stroke-dasharray","4,1"),i.appendChild(s);!function e(){if(requestAnimationFrame(e),u){var t;o.getByteFrequencyData(p);for(var n=0;n<255;n++)t=Math.floor(p[n])-Math.floor(p[n])%5,r[n].setAttribute("d","M "+n+",255 l 0,-"+t)}else for(n=0;n<255;n++)r[n].setAttribute("d","M "+n+",255 l 0,-0")}(),function e(){if(console.log("soundAllowed 1"),setTimeout(e,500),u){o.getByteFrequencyData(p),console.log("soundAllowed 2");for(var t=0,n=0;n<255;n++){var s=p[n];t+=s*s}var r=Math.sqrt(t/j),a=Math.log(r)/Math.log(10)*20;a=Math.max(a,0),c.innerHTML=Math.floor(a)+" dB",a>=30?(m+=.5)>=5&&(l.innerHTML="You\u2019ve been in loud environment for<span> "+Math.floor(m)+" </span>seconds."):(m=0,l.innerHTML="")}else c.innerHTML="",l.innerHTML=""}()},h=function(e){c.innerHTML="You must allow your microphone.",console.log(e)};t.querySelector("#button").onclick=function(){u?(u=!1,this.innerHTML="Start Listen",this.className=j.a.greenButton):(d||(navigator.mediaDevices.getUserMedia({audio:!0}).then(p).catch(h),o=window.AudioContext||window.webkitAudioContext,n=new o),u=!0,this.innerHTML="Stop Listen",this.className=j.a.redButton)}}),[]),{rootRef:e}}(),t=e.rootRef;return Object(m.jsxs)("div",{className:j.a.page,ref:t,children:[Object(m.jsxs)("svg",{preserveAspectRatio:"none",id:"visualizer",version:"1.1",xmlns:"http://www.w3.org/2000/svg",children:[Object(m.jsxs)("defs",{children:[Object(m.jsx)("mask",{id:"mask",children:Object(m.jsx)("g",{id:"maskGroup"})}),Object(m.jsxs)("linearGradient",{id:"gradient",x1:"0%",y1:"0%",x2:"0%",y2:"100%",children:[Object(m.jsx)("stop",{offset:"0%",style:{stopColor:"#db6247",stopOpacity:1}}),Object(m.jsx)("stop",{offset:"40%",style:{stopColor:"#f6e5d1",stopOpacity:1}}),Object(m.jsx)("stop",{offset:"60%",style:{stopColor:"#5c79c7",stopOpacity:1}}),Object(m.jsx)("stop",{offset:"85%",style:{stopColor:"#b758c0",stopOpacity:1}}),Object(m.jsx)("stop",{offset:"100%",style:{stopColor:"#222",stopOpacity:1}})]})]}),Object(m.jsx)("rect",{x:"0",y:"0",width:"100%",height:"100%",fill:"url(#gradient)",mask:"url(#mask)"})]}),Object(m.jsx)("h1",{className:j.a.mainText,children:"Please allow the use of your microphone."}),Object(m.jsx)("h1",{className:j.a.subText}),Object(m.jsx)("div",{className:j.a.buttonContainer,children:Object(m.jsx)("button",{id:"button",className:j.a.greenButton,children:"Start Listen"})})]})},h=function(e){var t=e.id;return Object(m.jsxs)(u.c,{id:t,children:[Object(m.jsx)(u.d,{children:"Mic test"}),Object(m.jsx)(p,{})]})},b=function(){var e=Object(n.useState)("home"),t=Object(l.a)(e,2),o=t[0],s=t[1];return Object(m.jsx)(u.a,{children:Object(m.jsx)(u.b,{children:Object(m.jsx)(u.e,{activePanel:o,children:Object(m.jsx)(h,{id:"home",go:function(e){s(e.currentTarget.dataset.to)}})})})})};c.a.send("VKWebAppInit"),a.a.render(Object(m.jsx)(b,{}),document.getElementById("root"))},9:function(e,t,o){e.exports={page:"Home_page__1jasW",mainText:"Home_mainText__gTljH",subText:"Home_subText__3jxBA",buttonContainer:"Home_buttonContainer__3Yy22",greenButton:"Home_greenButton__3IIsz",redButton:"Home_redButton__2uyVS"}}},[[140,1,2]]]);
//# sourceMappingURL=main.78ded2f0.chunk.js.map